{"format_version":"1.2","terraform_version":"1.10.6","variables":{"cors_origins":{"value":"http://localhost:3000,http://localhost:5173"},"docker_image":{"value":"gcr.io/cloudrun/placeholder"},"environment":{"value":"PROD"},"log_level":{"value":"INFO"},"max_instances":{"value":20},"min_instances":{"value":0},"project_id":{"value":"portfolio-477017"},"region":{"value":"us-central1"},"service_name":{"value":"portfolio-api"}},"planned_values":{"outputs":{"api_keys_secret_name":{"sensitive":false,"type":"string","value":"api-keys"},"artifact_registry_location":{"sensitive":false,"type":"string","value":"us-central1-docker.pkg.dev/portfolio-477017/backend-images"},"cloud_run_url":{"sensitive":false},"database_url_secret_name":{"sensitive":false,"type":"string","value":"database-url"},"github_actions_service_account":{"sensitive":false}},"root_module":{"resources":[{"address":"google_artifact_registry_repository.backend","mode":"managed","type":"google_artifact_registry_repository","name":"backend","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"cleanup_policies":[],"cleanup_policy_dry_run":null,"description":"Docker repository for backend API images","docker_config":[],"format":"DOCKER","kms_key_name":null,"labels":null,"location":"us-central1","maven_config":[],"mode":"STANDARD_REPOSITORY","project":"portfolio-477017","remote_repository_config":[],"repository_id":"backend-images","timeouts":null,"virtual_repository_config":[]},"sensitive_values":{"cleanup_policies":[],"docker_config":[],"effective_labels":{},"maven_config":[],"remote_repository_config":[],"terraform_labels":{},"virtual_repository_config":[]}},{"address":"google_project_iam_member.github_actions_artifact_writer","mode":"managed","type":"google_project_iam_member","name":"github_actions_artifact_writer","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"condition":[],"project":"portfolio-477017","role":"roles/artifactregistry.writer"},"sensitive_values":{"condition":[]}},{"address":"google_project_iam_member.github_actions_run_admin","mode":"managed","type":"google_project_iam_member","name":"github_actions_run_admin","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"condition":[],"project":"portfolio-477017","role":"roles/run.admin"},"sensitive_values":{"condition":[]}},{"address":"google_project_iam_member.github_actions_service_account_user","mode":"managed","type":"google_project_iam_member","name":"github_actions_service_account_user","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"condition":[],"project":"portfolio-477017","role":"roles/iam.serviceAccountUser"},"sensitive_values":{"condition":[]}},{"address":"google_project_iam_member.github_actions_storage_admin","mode":"managed","type":"google_project_iam_member","name":"github_actions_storage_admin","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"condition":[],"project":"portfolio-477017","role":"roles/storage.admin"},"sensitive_values":{"condition":[]}},{"address":"google_project_service.artifact_registry","mode":"managed","type":"google_project_service","name":"artifact_registry","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"disable_dependent_services":null,"disable_on_destroy":false,"project":"portfolio-477017","service":"artifactregistry.googleapis.com","timeouts":null},"sensitive_values":{}},{"address":"google_project_service.cloud_build","mode":"managed","type":"google_project_service","name":"cloud_build","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"disable_dependent_services":null,"disable_on_destroy":false,"project":"portfolio-477017","service":"cloudbuild.googleapis.com","timeouts":null},"sensitive_values":{}},{"address":"google_project_service.cloud_run","mode":"managed","type":"google_project_service","name":"cloud_run","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"disable_dependent_services":null,"disable_on_destroy":false,"project":"portfolio-477017","service":"run.googleapis.com","timeouts":null},"sensitive_values":{}},{"address":"google_project_service.secret_manager","mode":"managed","type":"google_project_service","name":"secret_manager","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"disable_dependent_services":null,"disable_on_destroy":false,"project":"portfolio-477017","service":"secretmanager.googleapis.com","timeouts":null},"sensitive_values":{}},{"address":"google_secret_manager_secret.api_keys","mode":"managed","type":"google_secret_manager_secret","name":"api_keys","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"annotations":null,"labels":null,"project":"portfolio-477017","replication":[{"auto":[{"customer_managed_encryption":[]}],"user_managed":[]}],"rotation":[],"secret_id":"api-keys","timeouts":null,"topics":[],"ttl":null,"version_aliases":null,"version_destroy_ttl":null},"sensitive_values":{"effective_annotations":{},"effective_labels":{},"replication":[{"auto":[{"customer_managed_encryption":[]}],"user_managed":[]}],"rotation":[],"terraform_labels":{},"topics":[]}},{"address":"google_secret_manager_secret.database_url","mode":"managed","type":"google_secret_manager_secret","name":"database_url","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"annotations":null,"labels":null,"project":"portfolio-477017","replication":[{"auto":[{"customer_managed_encryption":[]}],"user_managed":[]}],"rotation":[],"secret_id":"database-url","timeouts":null,"topics":[],"ttl":null,"version_aliases":null,"version_destroy_ttl":null},"sensitive_values":{"effective_annotations":{},"effective_labels":{},"replication":[{"auto":[{"customer_managed_encryption":[]}],"user_managed":[]}],"rotation":[],"terraform_labels":{},"topics":[]}},{"address":"google_service_account.github_actions","mode":"managed","type":"google_service_account","name":"github_actions","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"account_id":"github-actions-deploy","create_ignore_already_exists":null,"description":null,"disabled":false,"display_name":"GitHub Actions Deployment Service Account","project":"portfolio-477017","timeouts":null},"sensitive_values":{}}],"child_modules":[{"resources":[{"address":"module.cloud_run.google_cloud_run_service.backend","mode":"managed","type":"google_cloud_run_service","name":"backend","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":2,"values":{"autogenerate_revision_name":true,"location":"us-central1","name":"portfolio-api","project":"portfolio-477017","template":[{"metadata":[{"annotations":{"autoscaling.knative.dev/maxScale":"20","autoscaling.knative.dev/minScale":"0"}}],"spec":[{"container_concurrency":80,"containers":[{"args":null,"command":null,"env":[{"name":"API_KEYS","value":"","value_from":[{"secret_key_ref":[{"key":"latest","name":"api-keys"}]}]},{"name":"CORS_ORIGINS","value":"http://localhost:3000,http://localhost:5173","value_from":[]},{"name":"DATABASE_URL","value":"","value_from":[{"secret_key_ref":[{"key":"latest","name":"database-url"}]}]},{"name":"ENVIRONMENT","value":"PROD","value_from":[]},{"name":"LOG_LEVEL","value":"INFO","value_from":[]}],"env_from":[],"image":"gcr.io/cloudrun/placeholder","liveness_probe":[{"failure_threshold":3,"grpc":[],"http_get":[{"http_headers":[],"path":"/health","port":8000}],"initial_delay_seconds":0,"period_seconds":10,"timeout_seconds":1}],"ports":[{"container_port":8000,"protocol":null}],"resources":[{"limits":{"cpu":"1000m","memory":"512Mi"},"requests":null}],"startup_probe":[{"failure_threshold":3,"grpc":[],"http_get":[{"http_headers":[],"path":"/health","port":8000}],"initial_delay_seconds":0,"period_seconds":3,"tcp_socket":[],"timeout_seconds":1}],"volume_mounts":[],"working_dir":null}],"timeout_seconds":60,"volumes":[]}]}],"timeouts":null,"traffic":[{"latest_revision":true,"percent":100,"revision_name":null,"tag":null}]},"sensitive_values":{"metadata":[],"status":[],"template":[{"metadata":[{"annotations":{},"labels":{}}],"spec":[{"containers":[{"env":[{"value_from":[{"secret_key_ref":[{}]}]},{"value_from":[]},{"value_from":[{"secret_key_ref":[{}]}]},{"value_from":[]},{"value_from":[]}],"env_from":[],"liveness_probe":[{"grpc":[],"http_get":[{"http_headers":[]}]}],"ports":[{}],"resources":[{"limits":{}}],"startup_probe":[{"grpc":[],"http_get":[{"http_headers":[]}],"tcp_socket":[]}],"volume_mounts":[]}],"volumes":[]}]}],"traffic":[{}]}},{"address":"module.cloud_run.google_cloud_run_service_iam_member.public_access","mode":"managed","type":"google_cloud_run_service_iam_member","name":"public_access","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"condition":[],"location":"us-central1","member":"allUsers","role":"roles/run.invoker","service":"portfolio-api"},"sensitive_values":{"condition":[]}},{"address":"module.cloud_run.google_project_iam_member.secret_accessor","mode":"managed","type":"google_project_iam_member","name":"secret_accessor","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"condition":[],"project":"portfolio-477017","role":"roles/secretmanager.secretAccessor"},"sensitive_values":{"condition":[]}},{"address":"module.cloud_run.google_service_account.cloud_run","mode":"managed","type":"google_service_account","name":"cloud_run","provider_name":"registry.opentofu.org/hashicorp/google","schema_version":0,"values":{"account_id":"portfolio-api-sa","create_ignore_already_exists":null,"description":null,"disabled":false,"display_name":"Service Account for portfolio-api Cloud Run","project":"portfolio-477017","timeouts":null},"sensitive_values":{}}],"address":"module.cloud_run"}]}},"resource_changes":[{"address":"google_artifact_registry_repository.backend","mode":"managed","type":"google_artifact_registry_repository","name":"backend","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"cleanup_policies":[],"cleanup_policy_dry_run":null,"description":"Docker repository for backend API images","docker_config":[],"format":"DOCKER","kms_key_name":null,"labels":null,"location":"us-central1","maven_config":[],"mode":"STANDARD_REPOSITORY","project":"portfolio-477017","remote_repository_config":[],"repository_id":"backend-images","timeouts":null,"virtual_repository_config":[]},"after_unknown":{"cleanup_policies":[],"create_time":true,"docker_config":[],"effective_labels":true,"id":true,"maven_config":[],"name":true,"remote_repository_config":[],"terraform_labels":true,"update_time":true,"virtual_repository_config":[]},"before_sensitive":false,"after_sensitive":{"cleanup_policies":[],"docker_config":[],"effective_labels":{},"maven_config":[],"remote_repository_config":[],"terraform_labels":{},"virtual_repository_config":[]}}},{"address":"google_project_iam_member.github_actions_artifact_writer","mode":"managed","type":"google_project_iam_member","name":"github_actions_artifact_writer","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"condition":[],"project":"portfolio-477017","role":"roles/artifactregistry.writer"},"after_unknown":{"condition":[],"etag":true,"id":true,"member":true},"before_sensitive":false,"after_sensitive":{"condition":[]}}},{"address":"google_project_iam_member.github_actions_run_admin","mode":"managed","type":"google_project_iam_member","name":"github_actions_run_admin","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"condition":[],"project":"portfolio-477017","role":"roles/run.admin"},"after_unknown":{"condition":[],"etag":true,"id":true,"member":true},"before_sensitive":false,"after_sensitive":{"condition":[]}}},{"address":"google_project_iam_member.github_actions_service_account_user","mode":"managed","type":"google_project_iam_member","name":"github_actions_service_account_user","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"condition":[],"project":"portfolio-477017","role":"roles/iam.serviceAccountUser"},"after_unknown":{"condition":[],"etag":true,"id":true,"member":true},"before_sensitive":false,"after_sensitive":{"condition":[]}}},{"address":"google_project_iam_member.github_actions_storage_admin","mode":"managed","type":"google_project_iam_member","name":"github_actions_storage_admin","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"condition":[],"project":"portfolio-477017","role":"roles/storage.admin"},"after_unknown":{"condition":[],"etag":true,"id":true,"member":true},"before_sensitive":false,"after_sensitive":{"condition":[]}}},{"address":"google_project_service.artifact_registry","mode":"managed","type":"google_project_service","name":"artifact_registry","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"disable_dependent_services":null,"disable_on_destroy":false,"project":"portfolio-477017","service":"artifactregistry.googleapis.com","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"google_project_service.cloud_build","mode":"managed","type":"google_project_service","name":"cloud_build","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"disable_dependent_services":null,"disable_on_destroy":false,"project":"portfolio-477017","service":"cloudbuild.googleapis.com","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"google_project_service.cloud_run","mode":"managed","type":"google_project_service","name":"cloud_run","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"disable_dependent_services":null,"disable_on_destroy":false,"project":"portfolio-477017","service":"run.googleapis.com","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"google_project_service.secret_manager","mode":"managed","type":"google_project_service","name":"secret_manager","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"disable_dependent_services":null,"disable_on_destroy":false,"project":"portfolio-477017","service":"secretmanager.googleapis.com","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"google_secret_manager_secret.api_keys","mode":"managed","type":"google_secret_manager_secret","name":"api_keys","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"annotations":null,"labels":null,"project":"portfolio-477017","replication":[{"auto":[{"customer_managed_encryption":[]}],"user_managed":[]}],"rotation":[],"secret_id":"api-keys","timeouts":null,"topics":[],"ttl":null,"version_aliases":null,"version_destroy_ttl":null},"after_unknown":{"create_time":true,"effective_annotations":true,"effective_labels":true,"expire_time":true,"id":true,"name":true,"replication":[{"auto":[{"customer_managed_encryption":[]}],"user_managed":[]}],"rotation":[],"terraform_labels":true,"topics":[]},"before_sensitive":false,"after_sensitive":{"effective_annotations":{},"effective_labels":{},"replication":[{"auto":[{"customer_managed_encryption":[]}],"user_managed":[]}],"rotation":[],"terraform_labels":{},"topics":[]}}},{"address":"google_secret_manager_secret.database_url","mode":"managed","type":"google_secret_manager_secret","name":"database_url","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"annotations":null,"labels":null,"project":"portfolio-477017","replication":[{"auto":[{"customer_managed_encryption":[]}],"user_managed":[]}],"rotation":[],"secret_id":"database-url","timeouts":null,"topics":[],"ttl":null,"version_aliases":null,"version_destroy_ttl":null},"after_unknown":{"create_time":true,"effective_annotations":true,"effective_labels":true,"expire_time":true,"id":true,"name":true,"replication":[{"auto":[{"customer_managed_encryption":[]}],"user_managed":[]}],"rotation":[],"terraform_labels":true,"topics":[]},"before_sensitive":false,"after_sensitive":{"effective_annotations":{},"effective_labels":{},"replication":[{"auto":[{"customer_managed_encryption":[]}],"user_managed":[]}],"rotation":[],"terraform_labels":{},"topics":[]}}},{"address":"google_service_account.github_actions","mode":"managed","type":"google_service_account","name":"github_actions","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"account_id":"github-actions-deploy","create_ignore_already_exists":null,"description":null,"disabled":false,"display_name":"GitHub Actions Deployment Service Account","project":"portfolio-477017","timeouts":null},"after_unknown":{"email":true,"id":true,"member":true,"name":true,"unique_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.cloud_run.google_cloud_run_service.backend","module_address":"module.cloud_run","mode":"managed","type":"google_cloud_run_service","name":"backend","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"autogenerate_revision_name":true,"location":"us-central1","name":"portfolio-api","project":"portfolio-477017","template":[{"metadata":[{"annotations":{"autoscaling.knative.dev/maxScale":"20","autoscaling.knative.dev/minScale":"0"}}],"spec":[{"container_concurrency":80,"containers":[{"args":null,"command":null,"env":[{"name":"API_KEYS","value":"","value_from":[{"secret_key_ref":[{"key":"latest","name":"api-keys"}]}]},{"name":"CORS_ORIGINS","value":"http://localhost:3000,http://localhost:5173","value_from":[]},{"name":"DATABASE_URL","value":"","value_from":[{"secret_key_ref":[{"key":"latest","name":"database-url"}]}]},{"name":"ENVIRONMENT","value":"PROD","value_from":[]},{"name":"LOG_LEVEL","value":"INFO","value_from":[]}],"env_from":[],"image":"gcr.io/cloudrun/placeholder","liveness_probe":[{"failure_threshold":3,"grpc":[],"http_get":[{"http_headers":[],"path":"/health","port":8000}],"initial_delay_seconds":0,"period_seconds":10,"timeout_seconds":1}],"ports":[{"container_port":8000,"protocol":null}],"resources":[{"limits":{"cpu":"1000m","memory":"512Mi"},"requests":null}],"startup_probe":[{"failure_threshold":3,"grpc":[],"http_get":[{"http_headers":[],"path":"/health","port":8000}],"initial_delay_seconds":0,"period_seconds":3,"tcp_socket":[],"timeout_seconds":1}],"volume_mounts":[],"working_dir":null}],"timeout_seconds":60,"volumes":[]}]}],"timeouts":null,"traffic":[{"latest_revision":true,"percent":100,"revision_name":null,"tag":null}]},"after_unknown":{"id":true,"metadata":true,"status":true,"template":[{"metadata":[{"annotations":{},"generation":true,"labels":true,"name":true,"namespace":true,"resource_version":true,"self_link":true,"uid":true}],"spec":[{"containers":[{"env":[{"value_from":[{"secret_key_ref":[{}]}]},{"value_from":[]},{"value_from":[{"secret_key_ref":[{}]}]},{"value_from":[]},{"value_from":[]}],"env_from":[],"liveness_probe":[{"grpc":[],"http_get":[{"http_headers":[]}]}],"name":true,"ports":[{"name":true}],"resources":[{"limits":{}}],"startup_probe":[{"grpc":[],"http_get":[{"http_headers":[]}],"tcp_socket":[]}],"volume_mounts":[]}],"service_account_name":true,"serving_state":true,"volumes":[]}]}],"traffic":[{"url":true}]},"before_sensitive":false,"after_sensitive":{"metadata":[],"status":[],"template":[{"metadata":[{"annotations":{},"labels":{}}],"spec":[{"containers":[{"env":[{"value_from":[{"secret_key_ref":[{}]}]},{"value_from":[]},{"value_from":[{"secret_key_ref":[{}]}]},{"value_from":[]},{"value_from":[]}],"env_from":[],"liveness_probe":[{"grpc":[],"http_get":[{"http_headers":[]}]}],"ports":[{}],"resources":[{"limits":{}}],"startup_probe":[{"grpc":[],"http_get":[{"http_headers":[]}],"tcp_socket":[]}],"volume_mounts":[]}],"volumes":[]}]}],"traffic":[{}]}}},{"address":"module.cloud_run.google_cloud_run_service_iam_member.public_access","module_address":"module.cloud_run","mode":"managed","type":"google_cloud_run_service_iam_member","name":"public_access","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"condition":[],"location":"us-central1","member":"allUsers","role":"roles/run.invoker","service":"portfolio-api"},"after_unknown":{"condition":[],"etag":true,"id":true,"project":true},"before_sensitive":false,"after_sensitive":{"condition":[]}}},{"address":"module.cloud_run.google_project_iam_member.secret_accessor","module_address":"module.cloud_run","mode":"managed","type":"google_project_iam_member","name":"secret_accessor","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"condition":[],"project":"portfolio-477017","role":"roles/secretmanager.secretAccessor"},"after_unknown":{"condition":[],"etag":true,"id":true,"member":true},"before_sensitive":false,"after_sensitive":{"condition":[]}}},{"address":"module.cloud_run.google_service_account.cloud_run","module_address":"module.cloud_run","mode":"managed","type":"google_service_account","name":"cloud_run","provider_name":"registry.opentofu.org/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"account_id":"portfolio-api-sa","create_ignore_already_exists":null,"description":null,"disabled":false,"display_name":"Service Account for portfolio-api Cloud Run","project":"portfolio-477017","timeouts":null},"after_unknown":{"email":true,"id":true,"member":true,"name":true,"unique_id":true},"before_sensitive":false,"after_sensitive":{}}}],"output_changes":{"api_keys_secret_name":{"actions":["create"],"before":null,"after":"api-keys","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"artifact_registry_location":{"actions":["create"],"before":null,"after":"us-central1-docker.pkg.dev/portfolio-477017/backend-images","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"cloud_run_url":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"database_url_secret_name":{"actions":["create"],"before":null,"after":"database-url","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"github_actions_service_account":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.10.6","values":{"outputs":{"api_keys_secret_name":{"sensitive":false,"value":"api-keys","type":"string"},"artifact_registry_location":{"sensitive":false,"value":"us-central1-docker.pkg.dev/portfolio-477017/backend-images","type":"string"},"database_url_secret_name":{"sensitive":false,"value":"database-url","type":"string"}},"root_module":{}}},"configuration":{"provider_config":{"google":{"name":"google","full_name":"registry.opentofu.org/hashicorp/google","version_constraint":"~\u003e 5.0","expressions":{"project":{"references":["var.project_id"]},"region":{"references":["var.region"]}}}},"root_module":{"outputs":{"api_keys_secret_name":{"expression":{"references":["google_secret_manager_secret.api_keys.secret_id","google_secret_manager_secret.api_keys"]},"description":"Name of the API keys secret in Secret Manager"},"artifact_registry_location":{"expression":{"references":["var.region","var.project_id","google_artifact_registry_repository.backend.repository_id","google_artifact_registry_repository.backend"]},"description":"Location to push Docker images"},"cloud_run_url":{"expression":{"references":["module.cloud_run.service_url","module.cloud_run"]},"description":"URL of the deployed Cloud Run service"},"database_url_secret_name":{"expression":{"references":["google_secret_manager_secret.database_url.secret_id","google_secret_manager_secret.database_url"]},"description":"Name of the database URL secret in Secret Manager"},"github_actions_service_account":{"expression":{"references":["google_service_account.github_actions.email","google_service_account.github_actions"]},"description":"Service account email for GitHub Actions"}},"resources":[{"address":"google_artifact_registry_repository.backend","mode":"managed","type":"google_artifact_registry_repository","name":"backend","provider_config_key":"google","expressions":{"description":{"constant_value":"Docker repository for backend API images"},"format":{"constant_value":"DOCKER"},"location":{"references":["var.region"]},"repository_id":{"constant_value":"backend-images"}},"schema_version":0,"depends_on":["google_project_service.artifact_registry"]},{"address":"google_project_iam_member.github_actions_artifact_writer","mode":"managed","type":"google_project_iam_member","name":"github_actions_artifact_writer","provider_config_key":"google","expressions":{"member":{"references":["google_service_account.github_actions.email","google_service_account.github_actions"]},"project":{"references":["var.project_id"]},"role":{"constant_value":"roles/artifactregistry.writer"}},"schema_version":0},{"address":"google_project_iam_member.github_actions_run_admin","mode":"managed","type":"google_project_iam_member","name":"github_actions_run_admin","provider_config_key":"google","expressions":{"member":{"references":["google_service_account.github_actions.email","google_service_account.github_actions"]},"project":{"references":["var.project_id"]},"role":{"constant_value":"roles/run.admin"}},"schema_version":0},{"address":"google_project_iam_member.github_actions_service_account_user","mode":"managed","type":"google_project_iam_member","name":"github_actions_service_account_user","provider_config_key":"google","expressions":{"member":{"references":["google_service_account.github_actions.email","google_service_account.github_actions"]},"project":{"references":["var.project_id"]},"role":{"constant_value":"roles/iam.serviceAccountUser"}},"schema_version":0},{"address":"google_project_iam_member.github_actions_storage_admin","mode":"managed","type":"google_project_iam_member","name":"github_actions_storage_admin","provider_config_key":"google","expressions":{"member":{"references":["google_service_account.github_actions.email","google_service_account.github_actions"]},"project":{"references":["var.project_id"]},"role":{"constant_value":"roles/storage.admin"}},"schema_version":0},{"address":"google_project_service.artifact_registry","mode":"managed","type":"google_project_service","name":"artifact_registry","provider_config_key":"google","expressions":{"disable_on_destroy":{"constant_value":false},"project":{"references":["var.project_id"]},"service":{"constant_value":"artifactregistry.googleapis.com"}},"schema_version":0},{"address":"google_project_service.cloud_build","mode":"managed","type":"google_project_service","name":"cloud_build","provider_config_key":"google","expressions":{"disable_on_destroy":{"constant_value":false},"project":{"references":["var.project_id"]},"service":{"constant_value":"cloudbuild.googleapis.com"}},"schema_version":0},{"address":"google_project_service.cloud_run","mode":"managed","type":"google_project_service","name":"cloud_run","provider_config_key":"google","expressions":{"disable_on_destroy":{"constant_value":false},"project":{"references":["var.project_id"]},"service":{"constant_value":"run.googleapis.com"}},"schema_version":0},{"address":"google_project_service.secret_manager","mode":"managed","type":"google_project_service","name":"secret_manager","provider_config_key":"google","expressions":{"disable_on_destroy":{"constant_value":false},"project":{"references":["var.project_id"]},"service":{"constant_value":"secretmanager.googleapis.com"}},"schema_version":0},{"address":"google_secret_manager_secret.api_keys","mode":"managed","type":"google_secret_manager_secret","name":"api_keys","provider_config_key":"google","expressions":{"replication":[{"auto":[{}]}],"secret_id":{"constant_value":"api-keys"}},"schema_version":0,"depends_on":["google_project_service.secret_manager"]},{"address":"google_secret_manager_secret.database_url","mode":"managed","type":"google_secret_manager_secret","name":"database_url","provider_config_key":"google","expressions":{"replication":[{"auto":[{}]}],"secret_id":{"constant_value":"database-url"}},"schema_version":0,"depends_on":["google_project_service.secret_manager"]},{"address":"google_service_account.github_actions","mode":"managed","type":"google_service_account","name":"github_actions","provider_config_key":"google","expressions":{"account_id":{"constant_value":"github-actions-deploy"},"display_name":{"constant_value":"GitHub Actions Deployment Service Account"},"project":{"references":["var.project_id"]}},"schema_version":0}],"module_calls":{"cloud_run":{"source":"./modules/cloud-run","expressions":{"api_keys_secret":{"references":["google_secret_manager_secret.api_keys.secret_id","google_secret_manager_secret.api_keys"]},"cors_origins":{"references":["var.cors_origins"]},"database_url_secret":{"references":["google_secret_manager_secret.database_url.secret_id","google_secret_manager_secret.database_url"]},"environment":{"references":["var.environment"]},"image":{"references":["var.docker_image"]},"log_level":{"references":["var.log_level"]},"max_instances":{"references":["var.max_instances"]},"min_instances":{"references":["var.min_instances"]},"project_id":{"references":["var.project_id"]},"region":{"references":["var.region"]},"service_name":{"references":["var.service_name"]}},"module":{"outputs":{"region":{"expression":{"references":["google_cloud_run_service.backend.location","google_cloud_run_service.backend"]},"description":"Region where the service is deployed"},"service_account_email":{"expression":{"references":["google_service_account.cloud_run.email","google_service_account.cloud_run"]},"description":"Email of the service account used by Cloud Run"},"service_name":{"expression":{"references":["google_cloud_run_service.backend.name","google_cloud_run_service.backend"]},"description":"Name of the Cloud Run service"},"service_url":{"expression":{"references":["google_cloud_run_service.backend.status[0].url","google_cloud_run_service.backend.status[0]","google_cloud_run_service.backend.status","google_cloud_run_service.backend"]},"description":"URL of the Cloud Run service"}},"resources":[{"address":"google_cloud_run_service.backend","mode":"managed","type":"google_cloud_run_service","name":"backend","provider_config_key":"google","expressions":{"autogenerate_revision_name":{"constant_value":true},"location":{"references":["var.region"]},"name":{"references":["var.service_name"]},"project":{"references":["var.project_id"]},"template":[{"metadata":[{"annotations":{"references":["var.min_instances","var.max_instances"]}}],"spec":[{"container_concurrency":{"references":["var.concurrency"]},"containers":[{"env":[{"name":{"constant_value":"ENVIRONMENT"},"value":{"references":["var.environment"]}},{"name":{"constant_value":"LOG_LEVEL"},"value":{"references":["var.log_level"]}},{"name":{"constant_value":"CORS_ORIGINS"},"value":{"references":["var.cors_origins"]}},{"name":{"constant_value":"DATABASE_URL"},"value_from":[{"secret_key_ref":[{"key":{"constant_value":"latest"},"name":{"references":["var.database_url_secret"]}}]}]},{"name":{"constant_value":"API_KEYS"},"value_from":[{"secret_key_ref":[{"key":{"constant_value":"latest"},"name":{"references":["var.api_keys_secret"]}}]}]}],"image":{"references":["var.image"]},"liveness_probe":[{"failure_threshold":{"constant_value":3},"http_get":[{"path":{"constant_value":"/health"},"port":{"constant_value":8000}}],"initial_delay_seconds":{"constant_value":0},"period_seconds":{"constant_value":10},"timeout_seconds":{"constant_value":1}}],"ports":[{"container_port":{"constant_value":8000}}],"resources":[{"limits":{"references":["var.cpu","var.memory"]}}],"startup_probe":[{"failure_threshold":{"constant_value":3},"http_get":[{"path":{"constant_value":"/health"},"port":{"constant_value":8000}}],"initial_delay_seconds":{"constant_value":0},"period_seconds":{"constant_value":3},"timeout_seconds":{"constant_value":1}}]}],"service_account_name":{"references":["google_service_account.cloud_run.email","google_service_account.cloud_run"]},"timeout_seconds":{"references":["var.timeout_seconds"]}}]}],"traffic":[{"latest_revision":{"constant_value":true},"percent":{"constant_value":100}}]},"schema_version":2},{"address":"google_cloud_run_service_iam_member.public_access","mode":"managed","type":"google_cloud_run_service_iam_member","name":"public_access","provider_config_key":"google","expressions":{"location":{"references":["google_cloud_run_service.backend.location","google_cloud_run_service.backend"]},"member":{"constant_value":"allUsers"},"role":{"constant_value":"roles/run.invoker"},"service":{"references":["google_cloud_run_service.backend.name","google_cloud_run_service.backend"]}},"schema_version":0},{"address":"google_project_iam_member.secret_accessor","mode":"managed","type":"google_project_iam_member","name":"secret_accessor","provider_config_key":"google","expressions":{"member":{"references":["google_service_account.cloud_run.email","google_service_account.cloud_run"]},"project":{"references":["var.project_id"]},"role":{"constant_value":"roles/secretmanager.secretAccessor"}},"schema_version":0},{"address":"google_service_account.cloud_run","mode":"managed","type":"google_service_account","name":"cloud_run","provider_config_key":"google","expressions":{"account_id":{"references":["var.service_name"]},"display_name":{"references":["var.service_name"]},"project":{"references":["var.project_id"]}},"schema_version":0}],"variables":{"api_keys_secret":{"description":"Name of the Secret Manager secret containing API_KEYS"},"concurrency":{"default":80,"description":"Maximum concurrent requests per instance"},"cors_origins":{"default":"","description":"Comma-separated list of allowed CORS origins"},"cpu":{"default":"1000m","description":"CPU allocation (e.g., '1000m' for 1 vCPU)"},"database_url_secret":{"description":"Name of the Secret Manager secret containing DATABASE_URL"},"environment":{"default":"dev","description":"Environment name (dev, staging, prod)"},"image":{"description":"Docker image URL (e.g., gcr.io/project/image:tag)"},"log_level":{"default":"INFO","description":"Application log level"},"max_instances":{"default":20,"description":"Maximum number of instances"},"memory":{"default":"512Mi","description":"Memory allocation (e.g., '512Mi')"},"min_instances":{"default":0,"description":"Minimum number of instances (0 for scale-to-zero)"},"project_id":{"description":"GCP Project ID"},"region":{"default":"us-central1","description":"GCP region for Cloud Run service"},"service_name":{"description":"Name of the Cloud Run service"},"timeout_seconds":{"default":60,"description":"Request timeout in seconds"}}},"depends_on":["google_project_service.cloud_run","google_secret_manager_secret.database_url","google_secret_manager_secret.api_keys"]}},"variables":{"cors_origins":{"default":"http://localhost:3000,http://localhost:5173","description":"Comma-separated list of allowed CORS origins"},"docker_image":{"default":"gcr.io/cloudrun/placeholder","description":"Docker image URL for the backend (will be updated by CI/CD)"},"environment":{"default":"dev","description":"Environment name (dev, staging, prod)"},"log_level":{"default":"INFO","description":"Application log level (DEBUG, INFO, WARNING, ERROR)"},"max_instances":{"default":20,"description":"Maximum number of Cloud Run instances"},"min_instances":{"default":0,"description":"Minimum number of Cloud Run instances (0 for scale-to-zero)"},"project_id":{"description":"GCP Project ID"},"region":{"default":"us-central1","description":"GCP region for resources"},"service_name":{"default":"backend-api","description":"Name of the Cloud Run service"}}}},"relevant_attributes":[{"resource":"google_artifact_registry_repository.backend","attribute":["repository_id"]},{"resource":"google_secret_manager_secret.api_keys","attribute":["secret_id"]},{"resource":"google_secret_manager_secret.database_url","attribute":["secret_id"]},{"resource":"google_service_account.github_actions","attribute":["email"]},{"resource":"module.cloud_run.google_cloud_run_service.backend","attribute":["name"]},{"resource":"module.cloud_run.google_cloud_run_service.backend","attribute":["location"]},{"resource":"module.cloud_run.google_cloud_run_service.backend","attribute":["status",0,"url"]},{"resource":"module.cloud_run.google_service_account.cloud_run","attribute":["email"]}],"timestamp":"2025-11-02T19:47:32Z","errored":false}
